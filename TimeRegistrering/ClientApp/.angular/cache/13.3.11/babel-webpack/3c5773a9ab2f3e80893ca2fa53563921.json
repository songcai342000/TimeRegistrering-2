{"ast":null,"code":"import { Router } from '@angular/router';\nimport { TimeService } from '../time.service';\nimport { TimeRegistration } from '../timeRegistration';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../time.service\";\nimport * as i3 from \"@angular/forms\";\nexport let FunctionHeader1Component = /*#__PURE__*/(() => {\n  class FunctionHeader1Component {\n    constructor(router, timeService) {\n      this.router = router;\n      this.timeService = timeService;\n      this.userName = localStorage.getItem('userName');\n      this.userId = parseInt(localStorage.getItem('userId'));\n      this.time = new Date(Date.now());\n      this.dateWidth = '50px';\n      this.projectName = ['', 'ABC kidgarden construction', 'Sunshine primary school construction']; // timeRegistration = new TimeRegistration(0, 1, '', '', null, new Date(this.d.getFullYear(), this.d.getMonth(), this.d.getDate()));\n\n      this.timeRegistration = new TimeRegistration(0, this.userId, '', '', null, null);\n    } //@Output() registrationEmit = new EventEmitter();\n\n\n    ngOnInit() {\n      //this.loadOptions();\n      this.getUserId(); //sessionStorage.setItem('registrationId', this.registrationId.toString());\n\n      let d = new Date(Date.now());\n      this.earliestDate = new Date('d.getFullYear(), d.setMonth(d.getMonth() - 3), d.getDate()');\n    }\n\n    ngDestroy() {\n      this.removeOptions();\n    } //add a new registration\n\n\n    registrate(timeRegistration) {\n      let token = localStorage.getItem('authToken');\n\n      if (token == 'undefined' || token == null) {\n        //document.getElementById('projectError').innerHTML = 'Please log in!';\n        alert('Please log in!');\n        this.router.navigate(['login']);\n      } else {\n        if (this.timeRegistration.projectName != '' && this.timeRegistration.hours != null && this.timeRegistration.hours > 0 && this.timeRegistration.hours < 25 && new Date(this.timeRegistration.registrationTime) <= this.time) {\n          let digitals = this.timeRegistration.hours.toString().split('.');\n\n          if (digitals.length > 1) {\n            if (digitals[1] == '0' || digitals[1] == '5') {\n              alert('r');\n              this.timeService.newRegistration(this.timeRegistration);\n              this.project = '';\n              this.com = '';\n              this.hrs = null;\n              this.time = null; //if (location.href == 'https://localhost:44379/alltimesheets') {\n\n              if (location.href == 'https://timeregistrering-song.azurewebsites.net/alltimesheets') {\n                location.reload();\n                0;\n              }\n\n              this.router.navigate(['alltimesheets']);\n            }\n          } else {\n            this.timeService.newRegistration(this.timeRegistration);\n            this.project = '';\n            this.com = '';\n            this.hrs = null;\n            this.time = null; //if (location.href == 'https://localhost:44379/alltimesheets') {\n\n            if (location.href == 'https://timeregistrering-song.azurewebsites.net/alltimesheets') {\n              location.reload();\n              0;\n            }\n\n            this.router.navigate(['alltimesheets']);\n          }\n        }\n\n        if (this.timeRegistration.projectName == '') {\n          document.getElementById('projectError').innerHTML = 'Project name is required!';\n        }\n\n        if (this.timeRegistration.hours == null) {\n          document.getElementById('durationError').innerHTML = 'Duration is required!';\n        }\n\n        if (this.timeRegistration.registrationTime == null) {\n          document.getElementById('dateError').innerHTML = 'Date is required!';\n        }\n      }\n    }\n\n    getUserId() {\n      this.timeService.getUserId(this.userName).subscribe(userId => this.userId = userId);\n    }\n    /*errorHours(event: any) {\r\n      if (event.target.value != '' || event.target.value != 'undefined' && document.getElementById('durationError').innerHTML != '') {\r\n        document.getElementById('durationError').innerHTML = '';\r\n      }\r\n    }*/\n\n\n    loadOptions() {\n      let token = localStorage.getItem('authToken');\n      let s = document.getElementsByTagName('select');\n      let select = s[0];\n      let l = select.children.length;\n\n      if (token == 'undefined' || token == null) {\n        select.setAttribute('visibility', 'hidden');\n        alert('Please log in!');\n        this.router.navigate(['login']);\n      } else {\n        if (l == 0) {\n          for (let i = 0; i < 3; i++) {\n            let o = document.createElement('option');\n            let t = document.createTextNode(this.projectName[i]);\n            o.appendChild(t);\n            select.appendChild(o);\n          }\n        }\n      }\n    }\n\n    removeOptions() {\n      let s = document.getElementsByTagName('select');\n      let select = s[0];\n      let l = select.children.length;\n\n      for (let j = 0; j < 3; j++) {\n        select.children[j].remove();\n        j--;\n      }\n    }\n\n    projectErrorMessage(event) {\n      let elp = document.getElementById('projectError');\n\n      if (event.target.value == '') {\n        elp.innerHTML = 'Project name is required!';\n      } else {\n        elp.innerHTML = '';\n      }\n    }\n\n    durationErrorMessage(event) {\n      let eld = document.getElementById('durationError');\n      let v = event.target.value;\n\n      if (v == '') {\n        eld.innerHTML = 'Duration is required!';\n      } else if (v < 0 || v > 24) {\n        eld.innerHTML = 'Please enter a number between -1 and 25!';\n      } else if (v >= 0 && v <= 24) {\n        let digitals = v.toString().split('.');\n        let digital = v.toString().split('.')[1];\n\n        if (digitals.length > 1 && digital != 5 && digital != 0) {\n          eld.innerHTML = 'The number after digital point can only be 0 or 5!';\n        } else {\n          eld.innerHTML = '';\n        }\n      } else {\n        eld.innerHTML = '';\n      }\n      /*let s = document.getElementsByTagName('select');\r\n      let select = s[0];\r\n      if (select.children.length == 0) {\r\n        for (let i = 0; i < 3; i++) {\r\n          select.children[i].remove();\r\n          i--;\r\n        }\r\n      }*/\n\n    }\n\n    dateErrorMessage(event) {\n      let elda = document.getElementById('dateError');\n      this.newTimeValue = new Date(event.target.value);\n\n      if (event.target.value == '') {\n        elda.innerHTML = 'Date is required!';\n      } else if (this.newTimeValue > this.time) {\n        elda.innerHTML = 'Date cannot be later than today';\n      } else if (this.newTimeValue <= this.time) {\n        elda.innerHTML = '';\n      } else {\n        elda.innerHTML = '';\n      }\n    } //trigger input text change event\n\n    /* @HostListener('window:click', ['$event'])\r\n     handleStorage(event) {\r\n       let project = document.getElementById(\"projectName\");\r\n       let change = new Event('change', { bubbles: true });\r\n       project.dispatchEvent(change);\r\n     }*/\n\n\n    removeProject() {\n      let token = localStorage.getItem('authToken');\n      alert(token);\n\n      if (token == 'undefined' || token == null) {\n        let select = document.getElementById('projectName');\n        select.querySelectorAll('option').forEach(n => n.remove());\n      }\n    }\n\n  }\n\n  FunctionHeader1Component.ɵfac = function FunctionHeader1Component_Factory(t) {\n    return new (t || FunctionHeader1Component)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.TimeService));\n  };\n\n  FunctionHeader1Component.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: FunctionHeader1Component,\n    selectors: [[\"app-function-header1\"]],\n    decls: 49,\n    vars: 11,\n    consts: [[1, \"main\"], [\"registrationForm\", \"ngForm\"], [1, \"invisible\"], [\"id\", \"topTitle\"], [1, \"pb-0\"], [\"for\", \"projectName\", \"id\", \"projectLbl\"], [\"id\", \"selectDiv\"], [\"name\", \"projectName\", \"id\", \"projectName\", 3, \"ngModel\", \"value\", \"ngModelChange\", \"change\", \"click\"], [\"projectName\", \"ngModel\"], [\"id\", \"projectError\", 1, \"errorText\"], [\"for\", \"start-time\"], [\"type\", \"text\", \"id\", \"comment\", \"name\", \"comment\", \"pattern\", \".*\", \"minlength\", \"2\", 3, \"ngModel\", \"value\", \"ngModelChange\"], [\"comment\", \"ngModel\"], [\"for\", \"end-time\"], [\"type\", \"text\", \"id\", \"hours\", \"min\", \"0\", \"max\", \"24\", \"step\", \"0.5\", \"name\", \"hours\", 3, \"ngModel\", \"value\", \"ngModelChange\", \"change\"], [\"hours\", \"ngModel\"], [\"id\", \"durationError\", 1, \"errorText\"], [\"for\", \"date\"], [\"type\", \"date\", \"id\", \"date\", \"required\", \"\", \"name\", \"date\", 1, \"testDate\", 2, \"width\", \"9.73em\", \"height\", \"2.2em\", \"margin-left\", \"0.05em\", \"box-sizing\", \"border-box\", 3, \"min\", \"ngModel\", \"value\", \"ngModelChange\", \"change\"], [\"date\", \"ngModel\"], [\"id\", \"dateError\", 1, \"errorText\"], [\"type\", \"hidden\", 3, \"value\"], [\"id\", \"btnContainer\"], [\"type\", \"submit\", \"id\", \"registrationBtn\", 1, \"mr-2\", 2, \"box-sizing\", \"border-box\", 3, \"click\"], [1, \"reflection\"]],\n    template: function FunctionHeader1Component_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"form\", 1)(2, \"div\")(3, \"div\")(4, \"label\", 2);\n        i0.ɵɵtext(5, \"Empty\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(6, \"div\", 3)(7, \"h4\");\n        i0.ɵɵtext(8, \"Registrate your working time\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(9, \"div\")(10, \"div\")(11, \"div\", 4)(12, \"label\", 5);\n        i0.ɵɵtext(13, \"Project Name\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(14, \"div\", 6)(15, \"select\", 7, 8);\n        i0.ɵɵlistener(\"ngModelChange\", function FunctionHeader1Component_Template_select_ngModelChange_15_listener($event) {\n          return ctx.timeRegistration.projectName = $event;\n        })(\"change\", function FunctionHeader1Component_Template_select_change_15_listener($event) {\n          return ctx.projectErrorMessage($event);\n        })(\"click\", function FunctionHeader1Component_Template_select_click_15_listener() {\n          return ctx.loadOptions();\n        });\n        i0.ɵɵtext(17);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(18, \"div\", 9);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(19, \"div\")(20, \"div\", 4)(21, \"label\", 10);\n        i0.ɵɵtext(22, \"Comment\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(23, \"div\")(24, \"input\", 11, 12);\n        i0.ɵɵlistener(\"ngModelChange\", function FunctionHeader1Component_Template_input_ngModelChange_24_listener($event) {\n          return ctx.timeRegistration.comment = $event;\n        });\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(26, \"div\")(27, \"div\", 4)(28, \"label\", 13);\n        i0.ɵɵtext(29, \"Duration (hrs)\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(30, \"div\")(31, \"input\", 14, 15);\n        i0.ɵɵlistener(\"ngModelChange\", function FunctionHeader1Component_Template_input_ngModelChange_31_listener($event) {\n          return ctx.timeRegistration.hours = $event;\n        })(\"change\", function FunctionHeader1Component_Template_input_change_31_listener($event) {\n          return ctx.durationErrorMessage($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(33, \"div\", 16);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(34, \"div\")(35, \"div\", 4)(36, \"label\", 17);\n        i0.ɵɵtext(37, \"Date\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(38, \"div\")(39, \"input\", 18, 19);\n        i0.ɵɵlistener(\"ngModelChange\", function FunctionHeader1Component_Template_input_ngModelChange_39_listener($event) {\n          return ctx.timeRegistration.registrationTime = $event;\n        })(\"change\", function FunctionHeader1Component_Template_input_change_39_listener($event) {\n          return ctx.dateErrorMessage($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(41, \"div\", 20);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(42, \"div\")(43, \"div\");\n        i0.ɵɵelement(44, \"input\", 21);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(45, \"div\", 22)(46, \"button\", 23);\n        i0.ɵɵlistener(\"click\", function FunctionHeader1Component_Template_button_click_46_listener() {\n          return ctx.registrate(ctx.timeRegistration);\n        });\n        i0.ɵɵtext(47, \"Submit\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(48, \"div\", 24);\n        i0.ɵɵelementEnd()()()()();\n      }\n\n      if (rf & 2) {\n        const _r0 = i0.ɵɵreference(16);\n\n        i0.ɵɵadvance(15);\n        i0.ɵɵpropertyInterpolate(\"value\", ctx.project);\n        i0.ɵɵproperty(\"ngModel\", ctx.timeRegistration.projectName);\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate1(\" \", _r0, \" \");\n        i0.ɵɵadvance(7);\n        i0.ɵɵpropertyInterpolate(\"value\", ctx.com);\n        i0.ɵɵproperty(\"ngModel\", ctx.timeRegistration.comment);\n        i0.ɵɵadvance(7);\n        i0.ɵɵpropertyInterpolate(\"value\", ctx.hrs);\n        i0.ɵɵproperty(\"ngModel\", ctx.timeRegistration.hours);\n        i0.ɵɵadvance(8);\n        i0.ɵɵpropertyInterpolate(\"min\", ctx.earliestDate);\n        i0.ɵɵpropertyInterpolate(\"value\", ctx.time);\n        i0.ɵɵproperty(\"ngModel\", ctx.timeRegistration.registrationTime);\n        i0.ɵɵadvance(5);\n        i0.ɵɵpropertyInterpolate(\"value\", ctx.userId);\n      }\n    },\n    directives: [i3.ɵNgNoValidate, i3.NgControlStatusGroup, i3.NgForm, i3.SelectControlValueAccessor, i3.NgControlStatus, i3.NgModel, i3.DefaultValueAccessor, i3.PatternValidator, i3.MinLengthValidator, i3.RequiredValidator],\n    styles: [\".main[_ngcontent-%COMP%]{margin:0;padding:0}form[_ngcontent-%COMP%]{display:grid;grid-template-columns:35% 65%;background-color:#595959;color:#fff;height:auto;border-radius:0 0 4px 4px;font-size:.9em;margin:0}h4[_ngcontent-%COMP%]{padding:0;width:auto;height:auto;font-weight:600}form[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(1){display:grid;grid-template-rows:30% 70%;text-align:center}form[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(1) > div[_ngcontent-%COMP%]:nth-child(1){padding-top:1vh}#topTitle[_ngcontent-%COMP%]{vertical-align:middle}form[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){padding-top:1vh;display:grid;grid-template-columns:30% 30% 15% 15% 10%}form[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2) > div[_ngcontent-%COMP%]{display:grid;grid-template-rows:1.5em auto}form[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2) > div[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{padding-bottom:.3em;line-height:1.2em}label[_ngcontent-%COMP%]{padding:0}button[_ngcontent-%COMP%]{padding:.25em;font-size:1em;background-color:#b300b3;border-radius:25px;color:#fff;border-top:1px solid rgba(255,255,255,.2);border-left:1px solid rgba(255,255,255,.2);border-right:1px solid rgba(255,255,255,.2)}button[_ngcontent-%COMP%]:hover{background-color:#f3f}button[_ngcontent-%COMP%]:active, button[_ngcontent-%COMP%]:visited{background-color:#f6f}select[_ngcontent-%COMP%], input[_ngcontent-%COMP%]{height:2em;border-radius:2px}#projectName[_ngcontent-%COMP%], #comment[_ngcontent-%COMP%]{width:99%}#hours[_ngcontent-%COMP%]{width:98%}#date[_ngcontent-%COMP%]{width:100%;height:2.2em;box-sizing:border-box}button[_ngcontent-%COMP%]{width:90%;height:2em;vertical-align:central}input[type=date][_ngcontent-%COMP%]{font-size:.9em}div[_ngcontent-%COMP%]{margin:0}label[_ngcontent-%COMP%], button[_ngcontent-%COMP%], #projectError[_ngcontent-%COMP%], #durationError[_ngcontent-%COMP%], #dateError[_ngcontent-%COMP%]{font-weight:600}#btnContainer[_ngcontent-%COMP%]{padding-left:.4em}option[_ngcontent-%COMP%]{visibility:hidden}\"]\n  });\n  return FunctionHeader1Component;\n})();","map":null,"metadata":{},"sourceType":"module"}